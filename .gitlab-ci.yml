stages:          
  - triggers

backend-trigger:
  stage: triggers
  trigger:
    include:
      - gitlab-templates/backend.yml
    strategy: depend
  rules:
    - if: "$CI_COMMIT_REF_NAME == 'dev'"  
    - if: "$CI_COMMIT_REF_NAME == 'main'"
    - if: $CI_COMMIT_BEFORE_SHA == "0000000000000000000000000000000000000000"
      when: never
    - changes:
      - "backend/**/*"


frontend-trigger:
  stage : triggers
  trigger:
    include:
      - gitlab-templates/frontend.yml
    strategy: depend
  rules:
    - if: "$CI_COMMIT_REF_NAME == 'dev'"  
    - if: "$CI_COMMIT_REF_NAME == 'main'"
    - if: $CI_COMMIT_BEFORE_SHA == "0000000000000000000000000000000000000000"
      when: never
    - changes: 
      - "frontend/**/*"


dev-trigger:
  stage : triggers
  trigger:
    include:
      - gitlab-templates/dev.yml
    strategy: depend
  needs: [backend-trigger, frontend-trigger]
  rules: 
    - if: "$CI_COMMIT_REF_NAME == 'dev'"
